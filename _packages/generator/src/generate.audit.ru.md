```
   –ê—É–¥–∏—Ç –Ω–∞–ø–∏—Å–∞–Ω. –í–æ—Ç –∫—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –ø–æ 5 –∫—Ä–∏—Ç–µ—Ä–∏—è–º:
   –•–∞—Ä–¥–∫–æ–¥ (4 –ø—Ä–æ–±–ª–µ–º—ã)
   –ö—Ä–∏—Ç–∏—á–Ω–æ: /css/styles.css –∂—ë—Å—Ç–∫–æ –≤—à–∏—Ç –≤ —à–∞–±–ª–æ–Ω HTML (HtmlService.ts:163) ‚Äî –Ω–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∫–æ–Ω—Ñ–∏–≥–∞
   –í—ã—Å–æ–∫–∏–π: —Å—É–±–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è views/pages/ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–∞ –≤ –¥–≤—É—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö, –Ω–µ–ª—å–∑—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å
   –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ JSDoc-–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º Liquid –≤ —Ç—Ä—ë—Ö —Ñ–∞–π–ª–∞—Ö
   –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (3 –ø—Ä–æ–±–ª–µ–º—ã)
   –ö—Ä–∏—Ç–∏—á–Ω–æ: as any –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º–∞—Å—Å–æ–≤–æ (context as any, config as any) ‚Äî IServiceContext –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç registry, –∫–æ–Ω—Ñ–∏–≥ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω
   –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—É—Ç–µ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –≤ validateConfig()
   –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (4 –ø—Ä–æ–±–ª–µ–º—ã)
   createDefaultFileSystem() –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ 4 —Å–µ—Ä–≤–∏—Å–∞—Ö, —Ö–æ—Ç—è —É–∂–µ –µ—Å—Ç—å core/filesystem/node-filesystem.ts
   routeToViewFileName() ‚Äî –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–π –∫–æ–¥ –≤ CssService –∏ HtmlService
   formatSize() ‚Äî –æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤ –¥–≤—É—Ö Stage-—Ñ–∞–π–ª–∞—Ö
   Mock EventBus/Registry –≤ generate.ts ‚Äî –∞–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω
   –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å (5 –ø—Ä–æ–±–ª–µ–º)
   CssService –∂—ë—Å—Ç–∫–æ —Å–æ–∑–¥–∞—ë—Ç HtmlConverterService –≤–º–µ—Å—Ç–æ –ø–æ–ª—É—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ registry.resolve()
   –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ (ClassLog, UnCSS, Elements) –≤–Ω–µ Pipeline ‚Äî –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç continueOnError, –Ω–µ –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏—è
   TemplateService –∏ ViteBundleService ‚Äî –º—ë—Ä—Ç–≤—ã–π –∫–æ–¥ –≤ —Ç–µ–∫—É—â–µ–º –ø–∞–π–ø–ª–∞–π–Ω–µ
   steps/generate-css.ts –∏ steps/generate-html.ts ‚Äî –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏
   –ì–∏–±–∫–æ—Å—Ç—å (3 –ø—Ä–æ–±–ª–µ–º—ã)
   css.entryPath –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥–µ, –Ω–æ –Ω–∏–≥–¥–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
   inline-—Ä–µ–∂–∏–º —á–∏—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ ui8kit.local.css, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –∏—Ç–æ–≥–æ–≤—ã–π styles.css –æ—Ç PostCSS
   –î–≤–∞ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è —Ç–∏–ø–∞ –¥–ª—è –∫–æ–Ω—Ñ–∏–≥–∞ UNCSS
```

# –ê—É–¥–∏—Ç –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ `@ui8kit/generator`

> **–ê–≤—Ç–æ—Ä –∞—É–¥–∏—Ç–∞:** Senior Engineer  
> **–î–∞—Ç–∞:** 2026-02-21  
> **–í–µ—Ä—Å–∏—è –∫–æ–¥–∞:** –≤–µ—Ç–∫–∞ `improved`  
> **–û–±—ä–µ–∫—Ç –∞—É–¥–∏—Ç–∞:** `_packages/generator/src/`  
> **–ö—Ä–∏—Ç–µ—Ä–∏–∏:** –≥–∏–±–∫–æ—Å—Ç—å ¬∑ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å ¬∑ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ¬∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ¬∑ —Ö–∞—Ä–¥–∫–æ–¥

---

## 1. –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ **Orchestrator ‚Üí Pipeline ‚Üí Stage ‚Üí Service** –≤—ã—Å—Ç—Ä–æ–µ–Ω–∞ –≥—Ä–∞–º–æ—Ç–Ω–æ: —á—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ—ë–≤, DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (ServiceRegistry), EventBus –¥–ª—è —Ä–∞–∑–≤—è–∑–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –∏–Ω—ä–µ—Ü–∏—Ä—É–µ–º—ã–π FileSystem –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –≠—Ç–æ –¥–æ–±—Ä–æ—Ç–Ω–∞—è –æ—Å–Ω–æ–≤–∞ –¥–ª—è enterprise-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞.

–û–¥–Ω–∞–∫–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –µ—â—ë –Ω–µ –∑–∞–≤–µ—Ä—à—ë–Ω: –≤ –∫–æ–¥–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–µ—Ä–µ–∂–∏—Ç–∫–∏ Liquid, –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö `as any`. –ù–∏–∂–µ ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –ø–æ –∫–∞–∂–¥–æ–º—É –∫—Ä–∏—Ç–µ—Ä–∏—é.

---

## 2. –•–∞—Ä–¥–∫–æ–¥

### H-1 ¬∑ –ö–†–ò–¢–ò–ß–ù–û ¬∑ –ó–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ CSS –≤ HTML-–¥–æ–∫—É–º–µ–Ω—Ç–µ

**–§–∞–π–ª:** `services/html/HtmlService.ts:163`

```ts
`<link rel="stylesheet" href="/css/styles.css">`,
```

–ü—É—Ç—å `/css/styles.css` –∂—ë—Å—Ç–∫–æ –≤—à–∏—Ç –≤ —à–∞–±–ª–æ–Ω HTML-—Å—Ç—Ä–∞–Ω–∏—Ü—ã. –ù–µ—Ç –Ω–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∫–æ–Ω—Ñ–∏–≥–∞, –Ω–∏ –æ–ø—Ü–∏–∏ –≤ `HtmlServiceInput`. –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –¥–µ–ø–ª–æ–∏—Ç—Å—è –≤ –ø–æ–¥–ø–∞–ø–∫—É (`/app/`), CDN –∏–ª–∏ –º–µ–Ω—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É CSS-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ ‚Äî –Ω—É–∂–Ω–æ –ª–µ–∑—Ç—å –≤ –∏—Å—Ö–æ–¥–Ω–∏–∫.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `cssHref?: string` –≤ `HtmlServiceInput` —Å –¥–µ—Ñ–æ–ª—Ç–æ–º `/css/styles.css`. –õ–∏–±–æ –≤—ã—á–∏—Å–ª—è—Ç—å –ø—É—Ç—å –∏–∑ `cssOutputDir` –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ `outputDir`.

---

### H-2 ¬∑ –í–´–°–û–ö–ò–ô ¬∑ –ó–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω–∞—è —Å—É–±–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `views/pages/`

**–§–∞–π–ª—ã:** `services/css/CssService.ts:147`, `services/html/HtmlService.ts:96`

```ts
// CssService
const viewPath = join(viewsDir, 'pages', viewFileName);
// HtmlService
const viewPath = join(viewsDir, 'pages', viewFileName);
```

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ `{viewsDir}/pages/{file}.html` –∂—ë—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–∞ –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `html.viewsDir` –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç –∫–æ—Ä–µ–Ω—å, –Ω–æ –≤—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è `pages/`. –ù–µ—Ç —Å–ø–æ—Å–æ–±–∞ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –¥–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ `html.viewsPagesDir?: string` –≤ `IConfig.ts` (–¥–µ—Ñ–æ–ª—Ç `'pages'`). –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å –µ–≥–æ –≤ Input –æ–±–æ–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

---

### H-3 ¬∑ –°–†–ï–î–ù–ò–ô ¬∑ –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –ø—É—Ç–∏ –≤ `generate.ts`

**–§–∞–π–ª:** `generate.ts:160,187-189`

```ts
outputDir = config.classLog?.outputDir ?? './dist/maps'
variantsDir: elementsConfig.variantsDir ?? './src/variants'
outputDir:  elementsConfig.outputDir   ?? './src/elements'
```

–î–µ—Ñ–æ–ª—Ç—ã —Ä–∞–∑–±—Ä–æ—Å–∞–Ω—ã –ø–æ —Ç–µ–ª—É —Ñ—É–Ω–∫—Ü–∏–π `generateClassLog` –∏ `generateVariantElements`, –∞ –Ω–µ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ `DEFAULT_CONFIG`. –≠—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ —É—Å–ª–æ–∂–Ω—è–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –≤—Å–µ –¥–µ—Ñ–æ–ª—Ç—ã ‚Äî –≤ `IConfig.ts` –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É `DEFAULT_CONFIG` –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π `DEFAULT_GENERATE_CONFIG`.

---

### H-4 ¬∑ –ù–ò–ó–ö–ò–ô ¬∑ –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è Liquid

**–§–∞–π–ª—ã:** `stages/CssStage.ts:8`, `stages/HtmlStage.ts:8`, `services/class-log/ClassLogService.ts:64-65`

```ts
// CssStage
/** Extracts and generates CSS from Liquid views. */

// HtmlStage
/** Renders Liquid views through layout to final HTML. */

// ClassLogService
/** ClassLogService - Logs all classes used in Liquid views. */
```

–ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ Liquid –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—ë–Ω –∏–∑ –ø–∞–π–ø–ª–∞–π–Ω–∞, –Ω–æ —ç—Ç–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ—Å—Ç–∞–ª–∏—Å—å. –í–≤–æ–¥—è—Ç –≤ –∑–∞–±–ª—É–∂–¥–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –æ–±–Ω–æ–≤–∏—Ç—å JSDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ —Ç—Ä—ë—Ö —Ñ–∞–π–ª–∞—Ö.

---

## 3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### S-1 ¬∑ –ö–†–ò–¢–ò–ß–ù–û ¬∑ –ú–∞—Å—Å–æ–≤–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ `as any` –¥–ª—è –æ–±—Ö–æ–¥–∞ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏

**–§–∞–π–ª—ã:**
- `services/css/CssService.ts:101,132` ‚Äî `context as any`, `context.config as any`
- `services/html/HtmlService.ts:85` ‚Äî `this.context.config as any`
- `generate.ts:136` ‚Äî `config as any` –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ `ClassLogService`
- `generate.ts:84-90` ‚Äî `stage.output as { files?: Array<unknown> }`

```ts
// CssService.ts:101
const registry = (context as any).registry;

// CssService.ts:132
const variantsDir = (this.context.config as any)?.elements?.variantsDir ?? './src/variants';

// HtmlService.ts:85
const pureCssFileName = (this.context.config as any)?.css?.outputFiles?.pureCss ?? 'ui8kit.local.css';
```

–°—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã: `IServiceContext` –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç `registry` –ø—É–±–ª–∏—á–Ω–æ, –∞ –ø–æ–ª—è `config.elements` –∏ `config.css.outputFiles` –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ `GeneratorConfig` –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ. –≠—Ç–æ —Å–∏–º–ø—Ç–æ–º —Ç–æ–≥–æ, —á—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `IServiceContext` –Ω–µ –¥–æ—Ç—è–Ω—É—Ç –¥–æ –ø–æ–ª–Ω–æ—Ç—ã.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**  
1. –î–æ–±–∞–≤–∏—Ç—å `registry: IServiceRegistry` –≤ `IServiceContext`.  
2. –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞—Ç—å `context.config` –∫–∞–∫ `GeneratorConfig` —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –ø–æ–ª–µ–π.  
3. –£–±—Ä–∞—Ç—å –≤—Å–µ `as any` –∏–∑ —Å–µ—Ä–≤–∏—Å–æ–≤, –∑–∞–º–µ–Ω–∏–≤ –Ω–∞ —è–≤–Ω—ã–µ —Ç–∏–ø—ã.

---

### S-2 ¬∑ –í–´–°–û–ö–ò–ô ¬∑ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—É—Ç–µ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

**–§–∞–π–ª—ã:** `CssService.ts`, `HtmlService.ts`, `ClassLogService.ts`

–ü—É—Ç–∏ `viewsDir`, `outputDir`, `cssOutputDir` –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞ –±–µ–∑ —Å–∞–Ω–∞—Ü–∏–∏. –ü—Ä–∏–º–µ—Ä –∞—Ç–∞–∫–∏:

```ts
// –í –∫–æ–Ω—Ñ–∏–≥–µ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞:
{ html: { viewsDir: '../../etc', outputDir: '/tmp/pwned' } }
```

–î–ª—è CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ —ç—Ç–æ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –≤ CI/CD —Å –≤–Ω–µ—à–Ω–∏–º–∏ –∫–æ–Ω—Ñ–∏–≥–∞–º–∏.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –≤ `validateConfig()` –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `path.isAbsolute()` –∏–ª–∏ `path.resolve()` + –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞ (`ROOT`).

---

### S-3 ¬∑ –°–†–ï–î–ù–ò–ô ¬∑ –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞ `viewContent` –≤ HTML-–¥–æ–∫—É–º–µ–Ω—Ç

**–§–∞–π–ª:** `services/html/HtmlService.ts:100,174`

```ts
const viewContent = await this.fs.readFile(viewPath);
let html = this.buildSimpleHtmlDocument(routeConfig, appConfig, viewContent);
```

–ú–µ—Ç–æ–¥ `escapeHtml` –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ `title`, `description` –∏ –º–µ—Ç–∞—Ç–µ–≥–∞–º. –°–∞–º `viewContent` –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ `<body>` –±–µ–∑ –∫–∞–∫–æ–π-–ª–∏–±–æ –ø—Ä–æ–≤–µ—Ä–∫–∏. –ï—Å–ª–∏ —Ñ–∞–π–ª –≤—å—é –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≤–Ω–µ—à–Ω–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º –∏–ª–∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω ‚Äî –≤–æ–∑–º–æ–∂–Ω–∞ –∏–Ω—ä–µ–∫—Ü–∏—è. –î–ª—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ —Å–±–æ—Ä–∫–∏ —Ä–∏—Å–∫ –Ω–µ–≤—ã—Å–æ–∫, –Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —è–≤–Ω–æ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –¥–æ–±–∞–≤–∏—Ç—å JSDoc-–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: "viewContent –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –±–µ–∑ —Å–∞–Ω–∞—Ü–∏–∏; —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º –≤—ã—Ö–æ–¥–æ–º React SSR".

---

## 4. –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### R-1 ¬∑ –í–´–°–û–ö–ò–ô ¬∑ `createDefaultFileSystem()` –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ 4 –º–µ—Å—Ç–∞—Ö

**–§–∞–π–ª—ã:**  
- `services/css/CssService.ts:244-259`  
- `services/html/HtmlService.ts:243-258`  
- `services/class-log/ClassLogService.ts` (–∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –±–ª–æ–∫)  
- `services/html-converter/HtmlConverterService.ts` (–∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –±–ª–æ–∫)

–í—Å–µ —á–µ—Ç—ã—Ä–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã: `readFile`, `writeFile`, `mkdir` —á–µ—Ä–µ–∑ `node:fs/promises`. –ü—Ä–∏ —ç—Ç–æ–º –≤ –ø—Ä–æ–µ–∫—Ç–µ **—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç** `core/filesystem/node-filesystem.ts`.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –≤–æ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö –∑–∞–º–µ–Ω–∏—Ç—å `createDefaultFileSystem()` –Ω–∞ –∏–º–ø–æ—Ä—Ç `createNodeFileSystem()` –∏–∑ `core/filesystem`. –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã.

---

### R-2 ¬∑ –í–´–°–û–ö–ò–ô ¬∑ `routeToViewFileName()` –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ –¥–≤—É—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö

**–§–∞–π–ª—ã:** `services/css/CssService.ts:217-222`, `services/html/HtmlService.ts:135-138`

```ts
// –ò–¥–µ–Ω—Ç–∏—á–Ω—ã–π –∫–æ–¥ –≤ –æ–±–æ–∏—Ö —Ñ–∞–π–ª–∞—Ö:
private routeToViewFileName(routePath: string): string {
  if (routePath === '/') return 'index.html';
  return `${routePath.slice(1)}.html`;
}
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –≤—ã–Ω–µ—Å—Ç–∏ –≤ `core/utils/routes.ts` –∫–∞–∫ `routeToViewFileName(route: string): string`.

---

### R-3 ¬∑ –°–†–ï–î–ù–ò–ô ¬∑ `formatSize()` –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ –¥–≤—É—Ö Stage-—Ñ–∞–π–ª–∞—Ö

**–§–∞–π–ª—ã:** `stages/CssStage.ts:47-51`, `stages/HtmlStage.ts:47-51`

–ò–¥–µ–Ω—Ç–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–∞–π—Ç ‚Üí KB ‚Üí MB.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –≤—ã–Ω–µ—Å—Ç–∏ –≤ `core/utils/format.ts`.

---

### R-4 ¬∑ –°–†–ï–î–ù–ò–ô ¬∑ Mock EventBus –∏ ServiceRegistry –≤ `generate.ts`

**–§–∞–π–ª:** `generate.ts:138-157`

```ts
eventBus: {
  emit: () => {},
  on: () => () => {},
  once: () => () => {},
  // ...
} as any,
registry: {
  has: () => false,
  resolve: () => { throw new Error('Not implemented'); },
  // ...
} as any,
```

`generateClassLog` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç `ClassLogService` –≤–Ω–µ Orchestrator, –ø–µ—Ä–µ–¥–∞–≤–∞—è –≤—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∑–∞–≥–ª—É—à–∫–∏. –≠—Ç–æ –∞–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω: –Ω–∞—Ä—É—à–∞–µ—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç ClassLogService –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π EventBus.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å `ClassLogService` –≤ Orchestrator –≤ `generate-site.ts` –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å `ClassLogStage`. –£–±—Ä–∞—Ç—å mock-–æ–±—ä–µ–∫—Ç—ã.

---

## 5. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

### SC-1 ¬∑ –í–´–°–û–ö–ò–ô ¬∑ `CssService` –∂—ë—Å—Ç–∫–æ —Å–≤—è–∑–∞–Ω —Å `HtmlConverterService`

**–§–∞–π–ª:** `services/css/CssService.ts:88,93`

```ts
private htmlConverter: HtmlConverterService;

constructor(options: CssServiceOptions = {}) {
  this.htmlConverter = options.htmlConverter ?? new HtmlConverterService();
}
```

`CssService` —Å–æ–∑–¥–∞—ë—Ç `HtmlConverterService` –Ω–∞–ø—Ä—è–º—É—é. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è `.vue` –∏–ª–∏ `.svelte` —Ñ–∞–π–ª–æ–≤), –ø—Ä–∏–¥—ë—Ç—Å—è –º–µ–Ω—è—Ç—å `CssService`. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤ `initialize()` –µ—Å—Ç—å –ø–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä –∏–∑ registry, –Ω–æ —ç—Ç–æ fallback-–ª–æ–≥–∏–∫–∞, –∞ –Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—É—Ç—å.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**  
1. –û–±—ä—è–≤–∏—Ç—å `dependencies: readonly string[] = ['html-converter']` –≤ `CssService`.  
2. –ü–æ–ª—É—á–∞—Ç—å –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä **—Ç–æ–ª—å–∫–æ** —á–µ—Ä–µ–∑ `context.registry.resolve('html-converter')`.  
3. –£–±—Ä–∞—Ç—å fallback –∏–Ω—Å—Ç–∞–Ω—Ü–∏–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

### SC-2 ¬∑ –í–´–°–û–ö–ò–ô ¬∑ –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ (`ClassLog`, `UnCSS`, `Elements`) –≤–Ω–µ Pipeline

**–§–∞–π–ª:** `generate.ts:94-108`

```ts
if (config.classLog?.enabled)  await generateClassLog(config, logger);
if (config.uncss?.enabled)     await runUncssPostprocess(config.uncss, logger);
if (config.elements?.enabled)  await generateVariantElements(config, logger);
```

–¢—Ä–∏ –±–ª–æ–∫–∞ –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∏ ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –≤—ã–∑–æ–≤—ã –≤ `generate()` –≤–Ω–µ Orchestrator. –≠—Ç–æ:
- –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `continueOnError` –∏–∑ Orchestrator
- –ù–µ –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ `EventBus`
- –ù–µ–ª—å–∑—è –ø–µ—Ä–µ—Å—Ç–∞–≤–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å —á–µ—Ä–µ–∑ Pipeline API
- –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—Ç—ë—Ç –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ (`generate.ts`)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** —Å–æ–∑–¥–∞—Ç—å `ClassLogStage`, `UncssStage`, `ElementsStage` –∏ –¥–æ–±–∞–≤–ª—è—Ç—å –∏—Ö –≤ pipeline –ø—Ä–∏ `enabled: true`.

---

### SC-3 ¬∑ –°–†–ï–î–ù–ò–ô ¬∑ `TemplateService` –∏ `ViteBundleService` ‚Äî –º—ë—Ä—Ç–≤—ã–π –∫–æ–¥

**–§–∞–π–ª—ã:** `services/template/TemplateService.ts`, `services/vite-bundle/ViteBundleService.ts`

–û–±–∞ —Å–µ—Ä–≤–∏—Å–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –∏–∑ `services/index.ts` –∏ `index.ts`, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ `generate()` –∏–ª–∏ `runGenerateSitePipeline()`. `TemplateService` ‚Äî –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π 436-—Å—Ç—Ä–æ—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å; `ViteBundleService` ‚Äî —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**  
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –¥—Ä—É–≥–∏—Ö —Å–∫—Ä–∏–ø—Ç–∞—Ö ‚Äî —è–≤–Ω–æ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ.  
- –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –≤—ã–Ω–µ—Å—Ç–∏ –≤ `@deprecated` –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç, —á—Ç–æ–±—ã –Ω–µ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å bundle.

---

### SC-4 ¬∑ –°–†–ï–î–ù–ò–ô ¬∑ `plugins/` —Å–æ–¥–µ—Ä–∂–∞—Ç Liquid, Twig, Handlebars, Latte ‚Äî –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã

**–§–∞–π–ª—ã:** `plugins/template/built-in/`

–ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è Liquid –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞ –ø–ª–∞–≥–∏–Ω—ã `LiquidPlugin`, `TwigPlugin`, `HandlebarsPlugin`, `LattePlugin` –æ—Å—Ç–∞–ª–∏—Å—å –≤ –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –∏–∑ `index.ts`. –û–Ω–∏ –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –Ω–∏ –≤ –æ–¥–Ω–æ–º Stage, –Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ø—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ:  
- –û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã –∏ –Ω–∞–ø–∏—Å–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –∏—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é —á–µ—Ä–µ–∑ `orchestrator.use(new LiquidPlugin())`.  
- –ò–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç `@ui8kit/generator-plugins`.

---

### SC-5 ¬∑ –ù–ò–ó–ö–ò–ô ¬∑ –®–∞–≥–∏ `steps/generate-css.ts` –∏ `steps/generate-html.ts` ‚Äî –∏–∑–±—ã—Ç–æ—á–Ω—ã–π —Å–ª–æ–π

**–§–∞–π–ª—ã:** `steps/generate-css.ts` (28 —Å—Ç—Ä–æ–∫), `steps/generate-html.ts` (31 —Å—Ç—Ä–æ–∫–∞)

–ö–∞–∂–¥—ã–π step ‚Äî —Ç–æ–Ω–∫–∞—è –æ–±—ë—Ä—Ç–∫–∞, –∫–æ—Ç–æ—Ä–∞—è —Ç–æ–ª—å–∫–æ —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç `context` –∏ –≤—ã–∑—ã–≤–∞–µ—Ç `service.execute()`. –û–Ω–∏ –Ω–µ –¥–æ–±–∞–≤–ª—è—é—Ç –ª–æ–≥–∏–∫–∏, –∫–æ—Ç–æ—Ä—É—é –Ω–µ–ª—å–∑—è –±—ã–ª–æ –±—ã –ø–æ–º–µ—Å—Ç–∏—Ç—å –ø—Ä—è–º–æ –≤ Stage.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ª–∏–±–æ —É–¥–∞–ª–∏—Ç—å –∏ –∏–Ω–ª–∞–π–Ω–∏—Ç—å –≤ Stage, –ª–∏–±–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–µ —Ç–æ—á–∫–∏ —Å —Ä–µ–∞–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–æ–π (–≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥–∞). –°–µ–π—á–∞—Å ‚Äî –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è.

---

## 6. –ì–∏–±–∫–æ—Å—Ç—å

### F-1 ¬∑ –í–´–°–û–ö–ò–ô ¬∑ `css.entryPath` –≤ –∫–æ–Ω—Ñ–∏–≥–µ ‚Äî –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–§–∞–π–ª:** `core/interfaces/IConfig.ts:28`

```ts
css: {
  entryPath: string;  // –æ–±—ä—è–≤–ª–µ–Ω –∫–∞–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π
  ...
}
```

–ü–æ–ª–µ `css.entryPath` —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ñ–∏–≥–µ, –Ω–æ –Ω–∏ –≤ `CssService`, –Ω–∏ –≤ `CssStage` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è. –ü–æ —Å–º—ã—Å–ª—É —ç—Ç–æ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è PostCSS/Tailwind, –Ω–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ª–∏–±–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `entryPath` –≤ `CssService` –¥–ª—è PostCSS —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏, –ª–∏–±–æ –ø–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ `@deprecated` –∏ —É–±—Ä–∞—Ç—å –∏–∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π.

---

### F-2 ¬∑ –°–†–ï–î–ù–ò–ô ¬∑ `inline` —Ä–µ–∂–∏–º —á–∏—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ `ui8kit.local.css`, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç `styles.css`

**–§–∞–π–ª:** `services/html/HtmlService.ts:85-89`

```ts
const pureCssFileName = (this.context.config as any)?.css?.outputFiles?.pureCss ?? 'ui8kit.local.css';
cssContent = await this.fs.readFile(join(cssOutputDir, pureCssFileName));
```

–í —Ä–µ–∂–∏–º–µ `inline` CSS –±–µ—Ä—ë—Ç—Å—è –∏–∑ `ui8kit.local.css` (pure CSS), –Ω–æ —Ä–µ–∞–ª—å–Ω—ã–π –∏—Ç–æ–≥–æ–≤—ã–π CSS (–æ—Ç PostCSS + Tailwind) –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `styles.css`. Inline-—Ä–µ–∂–∏–º –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç–∏–ª–∏ –∏–∑ Tailwind.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –¥–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏—é `inlineCssFile?: string` –≤ `HtmlServiceInput` –¥–ª—è —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è —Ñ–∞–π–ª–∞.

---

### F-3 ¬∑ –ù–ò–ó–ö–ò–ô ¬∑ `IConfig.uncss` –∏ `UncssStepConfig` ‚Äî –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ

**–§–∞–π–ª—ã:** `core/interfaces/IConfig.ts:64-73`, `steps/postprocess-uncss.ts:5-14`

`GeneratorConfig.uncss` –∏ `UncssStepConfig` –æ–ø–∏—Å—ã–≤–∞—é—Ç –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ, –Ω–æ —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã. `GenerateConfig` —Ä–∞—Å—à–∏—Ä—è–µ—Ç `GeneratorConfig` –∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç `uncss` —á–µ—Ä–µ–∑ `UncssStepConfig`.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –æ—Å—Ç–∞–≤–∏—Ç—å –æ–¥–∏–Ω —Ç–∏–ø ‚Äî `UncssStepConfig` –≤ `core/interfaces/IConfig.ts`, —É–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

## 7. –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| ID   | –ö—Ä–∏—Ç–µ—Ä–∏–π          | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç  | –§–∞–π–ª(—ã)                                               | –î–µ–π—Å—Ç–≤–∏–µ                                    |
|------|-------------------|------------|-------------------------------------------------------|---------------------------------------------|
| H-1  | –•–∞—Ä–¥–∫–æ–¥           | üî¥ –ö–†–ò–¢.   | `HtmlService.ts:163`                                  | –î–æ–±–∞–≤–∏—Ç—å `cssHref` –≤ Input                  |
| H-2  | –•–∞—Ä–¥–∫–æ–¥           | üî¥ –í–´–°–û–ö.  | `CssService.ts:147`, `HtmlService.ts:96`              | –í—ã–Ω–µ—Å—Ç–∏ `pages/` –≤ –∫–æ–Ω—Ñ–∏–≥                   |
| H-3  | –•–∞—Ä–¥–∫–æ–¥           | üü° –°–†–ï–î.   | `generate.ts:160,187-189`                             | –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –¥–µ—Ñ–æ–ª—Ç—ã –≤ `DEFAULT_CONFIG`         |
| H-4  | –•–∞—Ä–¥–∫–æ–¥           | üü¢ –ù–ò–ó.    | `CssStage.ts:8`, `HtmlStage.ts:8`, `ClassLogService:64` | –û–±–Ω–æ–≤–∏—Ç—å JSDoc                            |
| S-1  | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å      | üî¥ –ö–†–ò–¢.   | `CssService.ts`, `HtmlService.ts`, `generate.ts`      | –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞—Ç—å `IServiceContext`, —É–±—Ä–∞—Ç—å `as any` |
| S-2  | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å      | üî¥ –í–´–°–û–ö.  | `validateConfig()`                                    | –î–æ–±–∞–≤–∏—Ç—å —Å–∞–Ω–∞—Ü–∏—é –ø—É—Ç–µ–π                       |
| S-3  | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å      | üü° –°–†–ï–î.   | `HtmlService.ts:100`                                  | –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∞     |
| R-1  | –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ | üî¥ –í–´–°–û–ö.  | 4 —Å–µ—Ä–≤–∏—Å–∞                                             | –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `createNodeFileSystem()`         |
| R-2  | –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ | üî¥ –í–´–°–û–ö.  | `CssService.ts`, `HtmlService.ts`                     | –í—ã–Ω–µ—Å—Ç–∏ `routeToViewFileName` –≤ utils        |
| R-3  | –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ | üü° –°–†–ï–î.   | `CssStage.ts`, `HtmlStage.ts`                         | –í—ã–Ω–µ—Å—Ç–∏ `formatSize` –≤ utils                |
| R-4  | –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ | üü° –°–†–ï–î.   | `generate.ts:138-157`                                 | –£–±—Ä–∞—Ç—å mock EventBus/Registry               |
| SC-1 | –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å  | üî¥ –í–´–°–û–ö.  | `CssService.ts:88`                                    | –ü–æ–ª—É—á–∞—Ç—å —á–µ—Ä–µ–∑ registry.resolve             |
| SC-2 | –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å  | üî¥ –í–´–°–û–ö.  | `generate.ts:94-108`                                  | –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ Stage-—ã                         |
| SC-3 | –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å  | üü° –°–†–ï–î.   | `TemplateService`, `ViteBundleService`                | –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –≤—ã–Ω–µ—Å—Ç–∏                  |
| SC-4 | –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å  | üü° –°–†–ï–î.   | `plugins/template/built-in/`                          | –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –≤—ã–Ω–µ—Å—Ç–∏ –≤ –ø–∞–∫–µ—Ç          |
| SC-5 | –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å  | üü¢ –ù–ò–ó.    | `steps/generate-css.ts`, `steps/generate-html.ts`    | –ò–Ω–ª–∞–π–Ω–∏—Ç—å –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É       |
| F-1  | –ì–∏–±–∫–æ—Å—Ç—å          | üî¥ –í–´–°–û–ö.  | `IConfig.ts:28`                                       | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å `css.entryPath`     |
| F-2  | –ì–∏–±–∫–æ—Å—Ç—å          | üü° –°–†–ï–î.   | `HtmlService.ts:85`                                   | –î–æ–±–∞–≤–∏—Ç—å `inlineCssFile` –≤ Input             |
| F-3  | –ì–∏–±–∫–æ—Å—Ç—å          | üü¢ –ù–ò–ó.    | `IConfig.ts`, `postprocess-uncss.ts`                  | –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø `uncss`                   |

---

## 8. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –ò—Ç–µ—Ä–∞—Ü–∏—è 1 ‚Äî –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∫–∏ (–±—ã—Å—Ç—Ä–æ, –≤—ã—Å–æ–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç)

1. **S-1:** –†–∞—Å—à–∏—Ä–∏—Ç—å `IServiceContext` –ø–æ–ª–µ–º `registry: IServiceRegistry`. –£–±—Ä–∞—Ç—å `as any` –∏–∑ `CssService` –∏ `HtmlService`.
2. **R-1:** –ó–∞–º–µ–Ω–∏—Ç—å `createDefaultFileSystem()` –≤ 4 —Å–µ—Ä–≤–∏—Å–∞—Ö –Ω–∞ `createNodeFileSystem()`.
3. **R-2:** –°–æ–∑–¥–∞—Ç—å `core/utils/routes.ts` —Å `routeToViewFileName`. –£–±—Ä–∞—Ç—å –¥—É–±–ª–∏.
4. **H-1:** –î–æ–±–∞–≤–∏—Ç—å `cssHref?: string` –≤ `HtmlServiceInput` —Å –¥–µ—Ñ–æ–ª—Ç–æ–º `/css/styles.css`.

### –ò—Ç–µ—Ä–∞—Ü–∏—è 2 ‚Äî –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

5. **SC-1:** –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å `CssService.initialize()` ‚Äî —Ç–æ–ª—å–∫–æ `registry.resolve('html-converter')`.
6. **SC-2:** –°–æ–∑–¥–∞—Ç—å `ClassLogStage`, `UncssStage`, `ElementsStage`. –£–±—Ä–∞—Ç—å post-processing –∏–∑ `generate.ts`.
7. **H-2:** –î–æ–±–∞–≤–∏—Ç—å `html.viewsPagesSubdir` –≤ –∫–æ–Ω—Ñ–∏–≥.

### –ò—Ç–µ—Ä–∞—Ü–∏—è 3 ‚Äî –ß–∏—Å—Ç–∫–∞

8. **H-4:** –û–±–Ω–æ–≤–∏—Ç—å JSDoc-–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (—É–±—Ä–∞—Ç—å —É–ø–æ–º–∏–Ω–∞–Ω–∏—è Liquid).
9. **SC-3, SC-4:** –ü—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ –ø–æ `TemplateService`, `ViteBundleService`, —É—Å—Ç–∞—Ä–µ–≤—à–∏–º –ø–ª–∞–≥–∏–Ω–∞–º.
10. **F-1:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `css.entryPath` –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ PostCSS –∏–ª–∏ –ø–æ–º–µ—Ç–∏—Ç—å `@deprecated`.
11. **F-3:** –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø—ã `uncss`.

---

*–ê—É–¥–∏—Ç –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç 96 —Ñ–∞–π–ª–æ–≤, 19 –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö ‚Äî 2, –≤—ã—Å–æ–∫–∏—Ö ‚Äî 8, —Å—Ä–µ–¥–Ω–∏—Ö ‚Äî 6, –Ω–∏–∑–∫–∏—Ö ‚Äî 3.*
